pipeline {
    agent any

    tools {
        maven 'Maven-3.9'
    }

    stages {

        stage('Checkout Code') {
            steps {
                git branch: 'master', url: 'https://github.com/jenkins-docs/simple-java-maven-app.git'
            }
        }

        stage('Build') {
            steps {
                bat 'mvn clean package'
            }
        }

        stage('Test') {
            steps {
                bat 'mvn test'
            }
        }
    }

    post {
        success {
            echo 'üéØ BUILD SUCCESS ‚Äî All stages completed!'
        }
        failure {
            echo '‚ùå BUILD FAILED!'
        }
    }
}



Title: Deploying a Static Login HTML Page on AWS EC2 Using Docker (Step-by-Step)

NOTE: This file explains every step in detail. You can follow it like a lab manual.

--------------------------------------------------
1. PREREQUISITES
--------------------------------------------------
1. You have:
   - An AWS account (can be Free Tier)
   - A laptop/PC with internet
   - Your GitHub repository URL:
     https://github.com/KumaraswamyBakkashetti/login-app2

2. You will:
   - Launch an Ubuntu EC2 instance
   - Connect to it using SSH
   - Install Docker and Git
   - Clone your GitHub repo (single HTML login page)
   - Create a Docker image using Nginx
   - Run a container and access the page through EC2 public IP

--------------------------------------------------
2. LOGIN TO AWS CONSOLE
--------------------------------------------------
1. Open your web browser (Chrome/Edge/Firefox).
2. Go to: https://aws.amazon.com/console/
3. Click on "Sign in to the Console".
4. Select "Root user" (if it's your main AWS account).
5. Enter your AWS account email and click "Next".
6. Enter your password and click "Sign in".
7. After login, check the region at the top-right (near your name).
   - Choose a nearby region, for example:
     "Asia Pacific (Mumbai) ap-south-1".

--------------------------------------------------
3. LAUNCH AN EC2 INSTANCE (UBUNTU)
--------------------------------------------------
1. On the AWS console home page, in the search bar at the top, type: EC2
2. Click on "EC2" from the search results.
3. You are now on the EC2 Dashboard.
4. Click the orange button "Launch instance".

You will now fill the "Launch an instance" form:

(A) Name and tags:
   - In the "Name" box, type:
     ubuntu-login-app

(B) Application and OS Images (AMI):
   - Under "Application and OS Images (Amazon Machine Image)",
     click on the dropdown or search bar.
   - Type: Ubuntu
   - Select:
     "Ubuntu Server 22.04 LTS (HVM), SSD Volume Type (Free tier eligible)"

(C) Instance type:
   - Ensure "Instance type" is set to:
     t2.micro  (Free Tier eligible)

(D) Key pair (login):
   - This is very important. It is used for SSH.
   - Under "Key pair (login)", click:
     "Create new key pair".
   - Key pair name: my-ec2-key
   - Key pair type: RSA
   - Private key file format: .pem
   - Click on "Create key pair".
   - A file named "my-ec2-key.pem" will be downloaded to your
     Downloads folder (or default download location).

(E) Network settings:
   - VPC: leave as default (example: vpc-xxxxxxxx).
   - Subnet: leave as "No preference (Default subnet in any Availability Zone)".
   - Auto-assign public IP: Ensure this is set to "Enable".

(F) Firewall (security groups):
   - Under "Firewall (security groups)", ensure:
     "Create security group" is selected.
   - Security group name can be default like: launch-wizard-1
   - Description: can be left as default.

   - Inbound security group rules:
     There should be some rules listed. Configure them as follows:

     Rule 1 (SSH):
       - Type: SSH
       - Protocol: TCP
       - Port range: 22
       - Source: My IP (recommended)
       This allows you to connect via SSH from your current machine.

     Rule 2 (HTTP):
       - Click "Add security group rule".
       - Type: HTTP
       - Protocol: TCP
       - Port range: 80
       - Source: Anywhere (0.0.0.0/0)
       This will allow web browsers to access your site.

     Rule 3 (HTTPS) (optional but OK to keep if present):
       - Type: HTTPS
       - Port: 443
       - Source: Anywhere (0.0.0.0/0)

(G) Storage:
   - Leave default: 8 GiB gp3 (root volume).

(H) Final launch:
   - Scroll to the bottom of the page.
   - Click the orange button "Launch instance".
   - After a few seconds, you should see "Success" at the top with
     a message that your instance is launching.
   - Click "View all instances".

--------------------------------------------------
4. GET THE PUBLIC IP OF YOUR EC2 INSTANCE
--------------------------------------------------
1. On the EC2 "Instances" page, you will see a list of instances.
2. Find the row with the Name: ubuntu-login-app.
3. Check:
   - "Instance state" is "running".
   - "Status check" shows "2/2 checks passed".
4. Look at the "Public IPv4 address" column.
   - It will look like: 3.110.25.120 (example).
5. Copy this IP address somewhere (Notepad, etc.).
   - You will use it for SSH and in the browser.

--------------------------------------------------
5. CONNECT TO EC2 USING SSH (FROM WINDOWS)
--------------------------------------------------
1. On your Windows machine, press Windows key, type: PowerShell
2. Click on "Windows PowerShell" to open it.
3. Go to the folder where your .pem key was downloaded.
   If it is in Downloads, type:

   cd $HOME\Downloads
   dir

   You should see the file: my-ec2-key.pem

4. Now use SSH command to connect (replace <PUBLIC-IP> with your real IP):

   ssh -i "my-ec2-key.pem" ubuntu@<PUBLIC-IP>

   Example:
   ssh -i "my-ec2-key.pem" ubuntu@3.110.25.120

5. The first time, it will ask:

   Are you sure you want to continue connecting (yes/no/[fingerprint])?

   Type: yes
   Press Enter.

6. If successful, your prompt will change to something like:

   ubuntu@ip-172-31-xx-xx:~$

   This means you are now inside your EC2 Ubuntu instance.

--------------------------------------------------
6. INSTALL DOCKER AND GIT ON EC2
--------------------------------------------------
Run the following commands one by one in the EC2 terminal
(the one that shows ubuntu@...):

1. Update package list:
2. Install Docker:
3. Start Docker service:
4. Enable Docker to start on boot:
5. Verify Docker installation:
6. Install Git:
7. Verify Git:

 sudo apt update -y
 sudo apt install docker.io -y
 sudo systemctl start docker
 sudo systemctl enable docker
 docker --version
 sudo apt install git -y
 git --version

--------------------------------------------------
7. CLONE YOUR GITHUB REPOSITORY (STATIC HTML + JENKINSFILE)
--------------------------------------------------
1. Ensure you are in the home directory:
2. Clone your GitHub repo using:
3. Move into the project directory:
3. Move into the project directory:
4. List files to confirm:

cd ~
git clone https://github.com/KumaraswamyBakkashetti/login-app2.git
cd login-app2
ls

   You should see your HTML file (for example: index.html or login.html)
   and Jenkinsfile, etc.

--------------------------------------------------
8. CREATE DOCKERFILE FOR STATIC HTML USING NGINX
--------------------------------------------------
We will use Nginx to serve your static HTML file inside a Docker container.

1. Inside the login-app2 directory, create a Dockerfile:
2. The nano editor will open. Type or paste the following content:
3. Save the Dockerfile:
4. Confirm the file exists:

nano Dockerfile
FROM nginx:alpine
COPY . /usr/share/nginx/html
EXPOSE 80


   - Press: Ctrl + O
   - Press: Enter (to confirm file name)
   - Press: Ctrl + X (to exit nano)



   ls

   You should see "Dockerfile" in the list.

--------------------------------------------------
9. BUILD THE DOCKER IMAGE
--------------------------------------------------
1. From inside the login-app2 directory, run:

sudo docker build -t loginapp .
sudo docker run -d -p 80:80 --name loginapp-container loginapp

   Explanation:
   - "loginapp" is the name (tag) of the Docker image.
   - "." means the current directory is the build context.

2. This will download nginx:alpine and copy your files.
   Wait until you see a message similar to:

   Successfully tagged loginapp:latest

--------------------------------------------------
10. RUN THE DOCKER CONTAINER
--------------------------------------------------
1. After the image is built, run a container mapping port 80:

   sudo docker run -d -p 80:80 --name loginapp-container loginapp

   Explanation:
   - "-d" runs the container in detached mode (in the background).
   - "-p 80:80" maps EC2 port 80 to container port 80.
   - "--name loginapp-container" gives the container a name.
   - "loginapp" is the image name.

2. Check if the container is running:

   sudo docker ps

   You should see a line with:
   IMAGE: loginapp
   PORTS: 0.0.0.0:80->80/tcp
   STATUS: Up ...

--------------------------------------------------
11. ACCESS THE LOGIN PAGE FROM YOUR BROWSER
--------------------------------------------------
1. On your local machine (laptop/PC), open a web browser.
2. In the address bar, type:

   http://<PUBLIC-IP>/

   Replace <PUBLIC-IP> with the EC2 public IP you copied earlier.
   Example:
   http://3.110.25.120/

3. Press Enter.
4. You should now see your login HTML page served from the EC2 instance
   via Docker and Nginx.

--------------------------------------------------
12. EXPECTED OUTPUTS / WHAT TO CAPTURE FOR REPORT
--------------------------------------------------
For assignment or project submission, you can capture:

1. EC2 instance details:
   - Screenshot of the EC2 Instances page showing:
     - Instance ID
     - Instance state: running
     - Public IPv4 address

2. SSH connection:
   - Screenshot of the PowerShell window showing successful SSH login.

3. Docker and Git installation:
   - Screenshot showing "docker --version" and "git --version" outputs.

4. Git clone:
   - Screenshot showing "git clone ..." and "ls" with your HTML file listed.

5. Docker build:
   - Screenshot showing "sudo docker build -t loginapp ." and final success line.

6. Running container:
   - Screenshot of "sudo docker ps" showing loginapp-container running
     with port 80 mapped.

7. Browser access:
   - Screenshot of browser with URL:
     http://<PUBLIC-IP>/
     and your login page visible.

--------------------------------------------------
13. SUMMARY (FOR WRITING IN EXAM / REPORT)
--------------------------------------------------
- Launched an Ubuntu EC2 instance (t2.micro, Ubuntu 22.04) with a
  security group allowing SSH (22) and HTTP (80) traffic.
- Connected to the instance using SSH and the downloaded .pem key.
- Installed Docker and Git on the instance using apt package manager.
- Cloned the GitHub repository containing a static login HTML page
  and a Jenkinsfile.
- Created a Dockerfile using nginx:alpine as the base image to serve
  the static HTML content.
- Built a Docker image from the project files and ran a container,
  mapping host port 80 to container port 80.
- Accessed the deployed login page from a web browser using the
  EC2 instance's public IP address, confirming successful deployment.

End of file.

